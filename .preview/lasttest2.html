<!doctype html>
<html>
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <title>Preview – lasttest2</title>

  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">
  

  <style>
    body{ font-family: Montserrat, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

    .overlay-toolbar{
      position: relative;
      top: 0;
      z-index: 60;
      backdrop-filter: blur(8px);
      background: rgba(255,255,255,.86);
      border-bottom: 1px solid rgba(0,0,0,.08);
    }

    /* Comparison root: stable container for screenshot diffs */
    #cmp_root{
      position: relative;
      width: 100%;
      min-height: var(--cmp-minh, 1px);
    }

    /* Background layer sits behind everything */
    .bg-layer{
      position:absolute;
      inset:0;
      z-index:0;
      pointer-events:none;
      overflow:hidden;
    }
    .bg-layer img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      display:block;
      object-fit: var(--bg-fit, cover);
      object-position: var(--bg-pos, center);
    }

    /* Content is above background */
    .content-layer{
      position:relative;
      z-index:10;
      width:100%;
    }

    /* Overlay image sits above rendered preview, without changing fragment DOM */
    .overlay-img{
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: auto;
      pointer-events: none;
      transform: translate(var(--ox, 0px), var(--oy, 0px));
      opacity: var(--oop, 0.5);
      mix-blend-mode: var(--obm, normal);
      z-index: 40;
    }

    .overlay-hidden{ display: none; }

    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      font-size: 12px;
      padding: 1px 6px;
      border: 1px solid rgba(0,0,0,.15);
      border-radius: 6px;
      background: rgba(255,255,255,.7);
    }

    /* --- Score modal --- */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.45);
      backdrop-filter: blur(4px);
      display:none;
      z-index: 1000;
      align-items:center;
      justify-content:center;
      padding: 24px;
    }
    .modal-backdrop[data-open="1"]{ display:flex; }

    .modal{
      width: min(920px, 100%);
      background:#fff;
      border-radius:16px;
      box-shadow: 0 20px 60px rgba(0,0,0,.22);
      border: 1px solid rgba(0,0,0,.08);
      overflow:hidden;
    }
    .modal-hd{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      padding: 16px 18px;
      border-bottom: 1px solid rgba(0,0,0,.08);
      background: rgba(248,250,252,.9);
    }
    .modal-title{ font-size: 14px; font-weight: 700; color:#0f172a; }
    .modal-sub{ font-size: 12px; color: rgba(15,23,42,.7); margin-top: 2px; }
    .modal-bd{ padding: 16px 18px; }
    .pill{
      display:inline-flex;
      align-items:center;
      gap: 8px;
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(0,0,0,.12);
      background: #fff;
      color:#0f172a;
      font-weight: 600;
    }
    .pill[data-kind="pass"]{ border-color: rgba(16,185,129,.35); background: rgba(16,185,129,.10); }
    .pill[data-kind="fail"]{ border-color: rgba(239,68,68,.35); background: rgba(239,68,68,.10); }

    .grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 720px){
      .grid{ grid-template-columns: 1fr; }
    }
    .card{
      border: 1px solid rgba(0,0,0,.08);
      border-radius: 14px;
      padding: 12px 12px;
      background: #fff;
    }
    .k{ font-size: 11px; color: rgba(15,23,42,.65); text-transform: uppercase; letter-spacing: .06em; }
    .v{ margin-top: 4px; font-size: 13px; color:#0f172a; font-weight: 600; }
    .mono{ font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace; }

    .modal-ft{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 14px 18px;
      border-top: 1px solid rgba(0,0,0,.08);
      background: rgba(248,250,252,.9);
      flex-wrap: wrap;
    }
    .btn2{
      font-size: 12px;
      padding: 8px 12px;
      border-radius: 10px;
      border: 1px solid rgba(0,0,0,.12);
      background: #fff;
      cursor:pointer;
    }
    .btn2:hover{ background: rgba(241,245,249,.8); }
    .btn2.primary{
      background: #0f172a;
      color:#fff;
      border-color: rgba(15,23,42,.3);
    }
    .btn2.primary:hover{ background:#111c33; }

    .links a{
      font-size: 12px;
      color:#0f172a;
      text-decoration: underline;
      text-underline-offset: 2px;
      opacity:.9;
      margin-right: 10px;
      white-space: nowrap;
    }
  </style>
</head>

<body class="antialiased bg-white">
  
  <div class="overlay-toolbar">
    <div class="max-w-[1100px] mx-auto px-4 py-3 flex flex-wrap items-center gap-3">
      <div class="flex items-center gap-2">
        <input id="ov_enabled" type="checkbox" checked />
        <label for="ov_enabled" class="text-sm font-medium">Figma overlay</label>
      </div>

      <div class="flex items-center gap-2">
        <label class="text-sm text-slate-700">Opacity</label>
        <input id="ov_opacity" type="range" min="0" max="100" value="50" />
        <span id="ov_opacity_val" class="text-sm text-slate-700 w-12">50%</span>
      </div>

      <div class="flex items-center gap-2">
        <input id="ov_diff" type="checkbox" />
        <label for="ov_diff" class="text-sm text-slate-700">Difference</label>
      </div>

      <button id="ov_reset" class="text-sm px-3 py-1 border rounded-md bg-white hover:bg-slate-50">
        Reset
      </button>

      <button id="ov_scores" class="text-sm px-3 py-1 border rounded-md bg-white hover:bg-slate-50">
        Scores
      </button>

      <div class="text-xs text-slate-600 ml-auto">
        Nudge: <span class="kbd">←</span><span class="kbd">→</span><span class="kbd">↑</span><span class="kbd">↓</span>
        &nbsp; (Shift = 10px)
      </div>
    </div>
  </div>
  

  <section class="relative flex overflow-hidden">
    <!-- Root must be relative so background + overlay can be absolutely positioned inside -->
    <div id="ov_root" class="relative flex flex-col items-center w-full mx-auto max-w-container max-lg:px-5  pt-5 pb-5">

      <!-- Dedicated comparison root for Playwright screenshotting -->
      <div
        id="cmp_root"
        style="--cmp-minh:878px; --bg-fit:cover; --bg-pos:center;"
      >
        
        <!-- Background image layer (from ast.__bg / root img) -->
        <div class="bg-layer" aria-hidden="true">
          <img data-figma-bg="1" src="/assets/fill_a94929a5bfc7f77233fd62ea-mk78kgs4.png" alt="" />
        </div>
        

        <!-- Content layer (actual fragment output) -->
        <div class="content-layer">
          <section class="relative flex overflow-hidden" style="background-image: linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%), url('/assets/fill_a94929a5bfc7f77233fd62ea-mk78kgs4.png'); background-size: cover; background-position: center; background-repeat: no-repeat;">
  <div class="flex w-full mx-auto max-w-[108rem] px-5 lg:px-0 pt-5 pb-5">
    <div data-node-id="3163:2414" data-node="3163:2414" class="flex w-full flex-col lg:flex-row lg:justify-end lg:items-center gap-2 px-5 lg:px-20 py-20 overflow-hidden">
      <div data-node-id="3163:2415" class="w-full max-w-[39.1875rem] shrink-0">
        <div data-node-id="3163:2415" data-node="3163:2415" class="flex flex-col gap-2 p-2 border-[0.3125rem] border-[rgba(9,2,164,1)]">
          <div data-node-id="3163:2416" class="w-full">
            <div data-node-id="3163:2416" data-node="3163:2416" class="flex flex-col gap-14 p-16 border-[0.1875rem] border-[rgba(9,2,164,1)]">
              <div data-node-id="3163:2417" class="w-full">
                <div data-node-id="3163:2417" data-node="3163:2417" role="group" aria-label="WHITNEY MOORE" class="flex flex-col items-start gap-4">
                  <div data-node-id="3163:2418" class="w-full">
                    <div data-node-id="3163:2418" data-node="3163:2418" role="group" aria-label="WHITNEY MOORE" class="flex flex-col items-start gap-2">
                      <div data-node-id="3163:2419">
                        <p data-node-id="3163:2419" data-node="3163:2419" data-ff="Montserrat" class="text-left text-[1.125rem] font-[500] tracking-[0.0625rem] text-[#000000] font-['Montserrat'] uppercase">WHITNEY MOORE</p>
                      </div>
                      <div data-node-id="3163:2420">
                        <h1 data-node-id="3163:2420" data-node="3163:2420" data-ff="Montserrat" class="text-left text-[4.25rem] font-[700] leading-[4.875rem] tracking-[0.0625rem] text-[#0902a4] font-['Montserrat']">Experience. Clarity. Results.</h1>
                      </div>
                    </div>
                  </div>
                  <div data-node-id="3163:2421">
                    <h3 data-node-id="3163:2421" data-node="3163:2421" data-ff="Montserrat" class="text-left text-[1.5rem] font-[500] tracking-[0.0625rem] text-[#000000] font-['Montserrat']">Driven by values since 1882.</h3>
                  </div>
                </div>
              </div>

              <div data-node-id="3163:2422" class="w-full">
                <div data-node-id="3163:2422" data-node="3163:2422" role="group" aria-label="buttons" class="flex flex-col sm:flex-row items-start sm:items-center gap-3">
                  <div data-node-id="3163:2423" class="w-full sm:w-[17.9375rem] shrink-0">
                    <button data-node-id="3163:2423" data-node="3163:2423" type="button" aria-label="View Practice Areas" class="w-full flex flex-row justify-center items-center gap-2 px-8 py-4 bg-[rgba(9,2,164,1)] bg-center shadow-[0.625rem_0.875rem_1.5rem_rgba(0,0,0,0.25)] btn inline-flex whitespace-nowrap hover:opacity-90 transition-opacity duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 min-h-14 lg:w-[17.9375rem] lg:h-[3.5rem] lg:min-h-0">
                      <span class="font-['Montserrat'] text-[1.25rem] leading-[1.25rem] tracking-[0.0625rem] font-[400] text-[rgba(255,255,255,1)]">View Practice Areas</span>
                    </button>
                  </div>
                  <div data-node-id="3163:2424" class="w-full sm:w-[9.8125rem] shrink-0">
                    <button data-node-id="3163:2424" data-node="3163:2424" type="button" aria-label="About Us" class="w-full flex flex-row justify-center items-center gap-2 px-8 py-4 bg-[rgba(219,234,254,1)] bg-center shadow-[1.25rem_0.875rem_1.5rem_rgba(0,0,0,0.07999999821186066)] btn inline-flex whitespace-nowrap hover:opacity-90 transition-opacity duration-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 min-h-14 lg:w-[9.8125rem] lg:h-[3.5rem] lg:min-h-0">
                      <span class="font-['Montserrat'] text-[1.25rem] leading-[1.25rem] font-[400] text-[rgba(29,78,216,1)]">About Us</span>
                    </button>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
        </div>
      </div>

      <img
              id="ov_img"
              data-figma-overlay="1"
              class="overlay-img"
              src="/assets/bgimage-mk78tgtw.png"
              alt=""
              aria-hidden="true"
            />
    </div>
  </section>

  <!-- Apply patches (fixtures.out/<slug>/patches.json) -->
  <script>
    (function(){
      const slug = "lasttest2";
      if (!slug) return;

      const PATCH_URL = "/fixtures.out/" + encodeURIComponent(slug) + "/patches.json";

      function asObj(v){ return (v && typeof v === 'object') ? v : null; }

      function applyPatchToEl(el, patch){
        if (!el || !patch) return;

        // classAdd
        if (Array.isArray(patch.classAdd)) {
          for (const c of patch.classAdd) {
            const cls = String(c || '').trim();
            if (cls) el.classList.add(cls);
          }
        }

        // classRemove
        if (Array.isArray(patch.classRemove)) {
          for (const c of patch.classRemove) {
            const cls = String(c || '').trim();
            if (cls) el.classList.remove(cls);
          }
        }

        // classReplace: { "gap-6": "gap-5", ... }
        if (asObj(patch.classReplace)) {
          for (const from in patch.classReplace) {
            const to = String(patch.classReplace[from] || '').trim();
            const fr = String(from || '').trim();
            if (!fr || !to) continue;
            if (el.classList.contains(fr)) {
              el.classList.remove(fr);
              el.classList.add(to);
            }
          }
        }

        // style: { transform: "...", marginTop: "...", ... }
        if (asObj(patch.style)) {
          for (const k in patch.style) {
            const v = patch.style[k];
            if (v === null || typeof v === 'undefined') continue;
            try { el.style[k] = String(v); } catch {}
          }
        }
      }

      async function loadPatches(){
        try{
          const r = await fetch(PATCH_URL, { cache: 'no-store' });
          if (!r.ok) return null;
          const json = await r.json();
          return asObj(json) || null;
        } catch {
          return null;
        }
      }

      function applyAll(patches){
        if (!patches) return;

        // IMPORTANT: support both attributes; renderer emits both in different places.
        const nodes = Array.from(document.querySelectorAll('[data-node-id],[data-node]'));

        for (const el of nodes) {
          const id =
            el.getAttribute('data-node-id') ||
            el.getAttribute('data-node') ||
            null;

          if (!id) continue;

          const p = patches[id];
          if (p) applyPatchToEl(el, p);
        }
      }

      (async function init(){
        const patches = await loadPatches();
        if (!patches) return;
        applyAll(patches);
      })();
    })();
  </script>

  
  <div id="score_modal_backdrop" class="modal-backdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="score_modal_title">
      <div class="modal-hd">
        <div>
          <div id="score_modal_title" class="modal-title">Visual diff scores</div>
          <div class="modal-sub">
            Slug: <span class="mono">lasttest2</span>
          </div>
        </div>
        <button id="score_modal_close" class="btn2" aria-label="Close">Close</button>
      </div>

      <div class="modal-bd">
        <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:12px;">
          <span id="score_pill" class="pill" data-kind="fail">No score loaded</span>
          <span id="score_main" class="mono" style="font-size:12px;color:rgba(15,23,42,.7)"></span>
        </div>

        <div class="grid">
          <div class="card">
            <div class="k">Diff ratio</div>
            <div id="score_diffRatio" class="v mono">—</div>
          </div>
          <div class="card">
            <div class="k">Diff pixels</div>
            <div id="score_diffPixels" class="v mono">—</div>
          </div>

          <div class="card">
            <div class="k">Threshold</div>
            <div id="score_threshold" class="v mono">—</div>
          </div>
          <div class="card">
            <div class="k">Pass diff ratio</div>
            <div id="score_passDiffRatio" class="v mono">—</div>
          </div>

          <div class="card">
            <div class="k">Viewport</div>
            <div id="score_viewport" class="v mono">—</div>
          </div>
          <div class="card">
            <div class="k">Timestamp</div>
            <div id="score_at" class="v mono">—</div>
          </div>
        </div>

        <div style="margin-top:14px;" class="links">
          <a id="score_link_score" href="#" target="_blank" rel="noreferrer">score.json</a>
          <a id="score_link_figma" href="#" target="_blank" rel="noreferrer">figma.png</a>
          <a id="score_link_render" href="#" target="_blank" rel="noreferrer">render.png</a>
          <a id="score_link_diff" href="#" target="_blank" rel="noreferrer">diff.png</a>
        </div>
      </div>

      <div class="modal-ft">
        <div style="font-size:12px;color:rgba(15,23,42,.7)">
          Tip: run compare after nudging overlay for a clean measurement.
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button id="score_run_compare" class="btn2 primary">Run compare</button>
          <button id="score_refresh" class="btn2">Refresh</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const img = document.getElementById('ov_img');
      const enabled = document.getElementById('ov_enabled');
      const opacity = document.getElementById('ov_opacity');
      const opacityVal = document.getElementById('ov_opacity_val');
      const diff = document.getElementById('ov_diff');
      const reset = document.getElementById('ov_reset');
      const root = document.getElementById('ov_root');

      if (!img || !root) return;

      const key = 'figmaOverlay:' + "lasttest2";
      const state = (() => {
        try { return JSON.parse(localStorage.getItem(key) || '{}') || {}; } catch { return {}; }
      })();

      const apply = () => {
        const on = enabled.checked;
        img.classList.toggle('overlay-hidden', !on);
        root.style.setProperty('--oop', String((Number(opacity.value)||0)/100));
        root.style.setProperty('--obm', diff.checked ? 'difference' : 'normal');
        root.style.setProperty('--ox', (state.ox||0) + 'px');
        root.style.setProperty('--oy', (state.oy||0) + 'px');
        opacityVal.textContent = (opacity.value || '0') + '%';
      };

      enabled.checked = state.enabled !== false;
      opacity.value = String(state.opacity ?? 50);
      diff.checked = !!state.diff;

      function save(){
        const next = {
          enabled: enabled.checked,
          opacity: Number(opacity.value)||0,
          diff: !!diff.checked,
          ox: state.ox||0,
          oy: state.oy||0
        };
        localStorage.setItem(key, JSON.stringify(next));
      }

      enabled.addEventListener('change', () => { save(); apply(); });
      opacity.addEventListener('input', () => { save(); apply(); });
      diff.addEventListener('change', () => { save(); apply(); });
      reset.addEventListener('click', () => {
        state.ox = 0; state.oy = 0;
        save(); apply();
      });

      window.addEventListener('keydown', (e) => {
        if (!enabled.checked) return;

        const step = e.shiftKey ? 10 : 1;
        let moved = false;

        if (e.key === 'ArrowLeft')  { state.ox = (state.ox||0) - step; moved = true; }
        if (e.key === 'ArrowRight') { state.ox = (state.ox||0) + step; moved = true; }
        if (e.key === 'ArrowUp')    { state.oy = (state.oy||0) - step; moved = true; }
        if (e.key === 'ArrowDown')  { state.oy = (state.oy||0) + step; moved = true; }

        if (moved) {
          e.preventDefault();
          save(); apply();
        }
      }, { passive: false });

      apply();

      // ---------------- Scores modal ----------------
      const scoreBtn = document.getElementById('ov_scores');
      const modalBackdrop = document.getElementById('score_modal_backdrop');
      const modalClose = document.getElementById('score_modal_close');
      const runCompareBtn = document.getElementById('score_run_compare');
      const refreshBtn = document.getElementById('score_refresh');

      const scoreEls = {
        pill: document.getElementById('score_pill'),
        main: document.getElementById('score_main'),
        diffRatio: document.getElementById('score_diffRatio'),
        diffPixels: document.getElementById('score_diffPixels'),
        threshold: document.getElementById('score_threshold'),
        passDiffRatio: document.getElementById('score_passDiffRatio'),
        viewport: document.getElementById('score_viewport'),
        at: document.getElementById('score_at'),
        linkScore: document.getElementById('score_link_score'),
        linkFigma: document.getElementById('score_link_figma'),
        linkRender: document.getElementById('score_link_render'),
        linkDiff: document.getElementById('score_link_diff'),
      };

      const slug = "lasttest2";

      function pct(x){
        const n = Number(x);
        if (!isFinite(n)) return '—';
        return (n * 100).toFixed(2) + '%';
      }

      function setModalOpen(isOpen){
        if (!modalBackdrop) return;
        modalBackdrop.dataset.open = isOpen ? "1" : "0";
        modalBackdrop.setAttribute('aria-hidden', isOpen ? 'false' : 'true');
      }

      function fmtDate(iso){
        try{
          const d = new Date(String(iso||''));
          if (!isFinite(d.getTime())) return '—';
          return d.toLocaleString();
        } catch { return '—'; }
      }

      function applyScore(score){
        if (!scoreEls.pill) return;

        if (!score){
          scoreEls.pill.dataset.kind = "fail";
          scoreEls.pill.textContent = "No score found";
          scoreEls.main.textContent = "";
          scoreEls.diffRatio.textContent = "—";
          scoreEls.diffPixels.textContent = "—";
          scoreEls.threshold.textContent = "—";
          scoreEls.passDiffRatio.textContent = "—";
          scoreEls.viewport.textContent = "—";
          scoreEls.at.textContent = "—";
          return;
        }

        const pass = !!score.pass;

        scoreEls.pill.dataset.kind = pass ? "pass" : "fail";
        scoreEls.pill.textContent = pass ? "PASS" : "FAIL";

        scoreEls.main.textContent =
          `diffRatio ${pct(score.diffRatio)} · pass<=${pct(score.compare?.passDiffRatio)}`;

        scoreEls.diffRatio.textContent = pct(score.diffRatio);
        scoreEls.diffPixels.textContent = String(score.diffPixels ?? '—');
        scoreEls.threshold.textContent = String(score.compare?.threshold ?? '—');
        scoreEls.passDiffRatio.textContent = pct(score.compare?.passDiffRatio);
        scoreEls.viewport.textContent =
          score.viewport?.width && score.viewport?.height
            ? `${score.viewport.width}×${score.viewport.height}`
            : '—';
        scoreEls.at.textContent = fmtDate(score.at);

        const base = `/fixtures.out/${encodeURIComponent(slug)}`;
        if (scoreEls.linkScore) scoreEls.linkScore.href = `${base}/score.json`;
        if (scoreEls.linkFigma) scoreEls.linkFigma.href = `${base}/figma.png`;
        if (scoreEls.linkRender) scoreEls.linkRender.href = `${base}/render.png`;
        if (scoreEls.linkDiff) scoreEls.linkDiff.href = `${base}/diff.png`;
      }

      async function loadLatestScore(){
        try{
          const r = await fetch(`/fixtures.out/${encodeURIComponent(slug)}/score.json`, { cache: 'no-store' });
          if (!r.ok) return null;
          return await r.json();
        } catch {
          return null;
        }
      }

      async function runCompare(){
        const body = {
          waitMs: 350,
          screenshot: { mode: "element", selector: "#cmp_root", minHeight: 50 }
        };

        const r = await fetch(`/api/compare/${encodeURIComponent(slug)}`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(body),
        });

        const out = await r.json().catch(() => null);
        if (!r.ok || !out?.ok) {
          const msg = out?.error ? String(out.error) : `Compare failed (${r.status})`;
          throw new Error(msg);
        }
        return out.score;
      }

      async function openScores(){
        setModalOpen(true);
        if (scoreEls.pill) scoreEls.pill.textContent = "Loading…";
        const score = await loadLatestScore();
        applyScore(score);
      }

      if (scoreBtn) scoreBtn.addEventListener('click', () => { openScores(); });

      if (modalClose) modalClose.addEventListener('click', () => setModalOpen(false));
      if (modalBackdrop) {
        modalBackdrop.addEventListener('click', (e) => {
          if (e.target === modalBackdrop) setModalOpen(false);
        });
      }

      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') setModalOpen(false);
      });

      if (refreshBtn) refreshBtn.addEventListener('click', async () => {
        if (scoreEls.pill) scoreEls.pill.textContent = "Loading…";
        const score = await loadLatestScore();
        applyScore(score);
      });

      if (runCompareBtn) runCompareBtn.addEventListener('click', async () => {
        try{
          runCompareBtn.disabled = true;
          runCompareBtn.textContent = "Running…";
          const score = await runCompare();
          applyScore(score);
        } catch (e){
          if (scoreEls.pill) {
            scoreEls.pill.dataset.kind = "fail";
            scoreEls.pill.textContent = "Compare error";
          }
          if (scoreEls.main) scoreEls.main.textContent = (e && e.message) ? e.message : String(e);
        } finally {
          runCompareBtn.disabled = false;
          runCompareBtn.textContent = "Run compare";
        }
      });
    })();
  </script>
  
</body>
</html>